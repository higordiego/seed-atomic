{"version":3,"sources":["../src/angular-flash.js"],"names":[],"mappings":"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","file":"angular-flash.js","sourcesContent":["const app = angular.module('ngFlash', []);\n\napp.run([\n    '$rootScope', function($rootScope) {\n        return $rootScope.flashes = [];\n    }\n]);\n\napp.directive('dynamic', [\n    '$compile', function($compile) {\n        return {\n            restrict: 'A',\n            replace: true,\n            link: function(scope, ele, attrs) {\n                return scope.$watch(attrs.dynamic, function(html) {\n                    ele.html(html);\n                    return $compile(ele.contents())(scope);\n                });\n            }\n        };\n    }\n]);\n\napp.directive('applytransclude', [\n    '$compile', function($compile) {\n        return {\n            restrict: 'A',\n            link: function(scope, ele, attrs) {\n                scope._transclude(scope, function(clone, scope) {\n                    ele.empty().append(clone);\n                });\n            }\n        };\n    }\n]);\n\napp.directive('closeFlash', [\n    '$compile', '$rootScope', 'Flash', function($compile, $rootScope, Flash) {\n        return {\n            link: function(scope, ele, attrs) {\n                return ele.on('click', function() {\n                    let id = parseInt(attrs.closeFlash, 10);\n                    Flash.dismiss(id);\n                    $rootScope.$apply();\n                });\n            }\n        };\n    }\n]);\n\napp.directive('flashMessage', [\n    'Flash', function(Flash) {\n        return {\n            restrict: 'E',\n            scope: {\n                duration: '=',\n                showClose: '=',\n                onDismiss: '&',\n                name: '@'\n            },\n            link: function(scope, ele, attrs, ctrl, transclude) {\n                Flash.setTimeout(scope.duration);\n                Flash.setShowClose(scope.showClose);\n                function onDismiss(flash) {\n                    if (typeof scope.onDismiss !== 'function') return;\n                    scope.onDismiss({flash: flash});\n                }\n\n                Flash.setOnDismiss(onDismiss);\n\n                if (Flash.config.templateTransclude) {\n                    scope._transclude = transclude;\n                }\n            },\n            transclude: Flash.config.templateTransclude,\n            template: `\n                <div ng-repeat=\"flash in $root.flashes track by $index\" ng-if=\"flash.config.container === name\" class=\"alert-container\">\n                    ` + Flash.config.template + `\n                </div>\n            `\n        };\n    }\n]);\n\napp.provider('Flash', function() {\n    let defaultConfig = {};\n    let templatePresets = {\n        bootstrap: {\n            html: `\n                <div role=\"alert\" id=\"{{flash.config.id}}\"\n                    class=\"alert {{flash.config.class}} alert-{{flash.type}} alert-dismissible alertIn alertOut\">\n                    <div type=\"button\" class=\"close\" ng-show=\"flash.showClose\" close-flash=\"{{flash.id}}\">\n                        <span aria-hidden=\"true\">&times;</span>\n                        <span class=\"sr-only\">Close</span>\n                    </div>\n                    <span dynamic=\"flash.text\"></span>\n                </div>`,\n            transclude: false\n        },\n        transclude: {\n            html: `<div applytransclude></div>`,\n            transclude: true\n        }\n    };\n\n    this.setTimeout = function(timeout) {\n        if (typeof timeout !== 'number') return;\n        defaultConfig.timeout = timeout;\n    };\n    this.setShowClose = function(value) {\n        if (typeof value !== 'boolean') return;\n        defaultConfig.showClose = value;\n    };\n    this.setTemplate = function(template) {\n        if (typeof template !== 'string') return;\n        defaultConfig.template = template;\n    };\n    this.setTemplatePreset = function(preset) {\n        if (typeof preset !== 'string'\n            || !(preset in templatePresets)) return;\n\n        let template = templatePresets[preset];\n        this.setTemplate(template.html);\n        defaultConfig.templateTransclude = template.transclude;\n    };\n    this.setOnDismiss = function(callback) {\n        if (typeof callback !== 'function') return;\n        defaultConfig.onDismiss = callback;\n    };\n\n    this.setTimeout(5000);\n    this.setShowClose(true);\n    this.setTemplatePreset('bootstrap');\n\n    this.$get = ['$rootScope', '$timeout', function($rootScope, $timeout) {\n        const dataFactory = {};\n        let counter = 0;\n\n        dataFactory.setTimeout = this.setTimeout;\n        dataFactory.setShowClose = this.setShowClose;\n        dataFactory.setOnDismiss = this.setOnDismiss;\n        dataFactory.config = defaultConfig;\n\n        dataFactory.create = function(type, text, timeout, config, showClose) {\n            if (!text) return false;\n            let $this, flash;\n            $this = this;\n            flash = {\n                type: type,\n                text: text,\n                config: config,\n                id: counter++\n            };\n            flash.showClose =\n                typeof showClose !== 'undefined' ?\n                    showClose : defaultConfig.showClose;\n            if (defaultConfig.timeout && typeof timeout === 'undefined') {\n                flash.timeout = defaultConfig.timeout;\n            }\n            else if (timeout) {\n                flash.timeout = timeout;\n            }\n            $rootScope.flashes.push(flash);\n            if (flash.timeout) {\n                flash.timeoutObj = $timeout(function() {\n                    $this.dismiss(flash.id);\n                }, flash.timeout);\n            }\n            return flash.id;\n        };\n        dataFactory.pause = function(index) {\n            if ($rootScope.flashes[index].timeoutObj) {\n                $timeout.cancel($rootScope.flashes[index].timeoutObj);\n            }\n        };\n        dataFactory.dismiss = function(id) {\n            const index = findIndexById(id);\n            if (index !== -1) {\n                const flash = $rootScope.flashes[index];\n                dataFactory.pause(index);\n                $rootScope.flashes.splice(index, 1);\n                if (typeof defaultConfig.onDismiss === 'function') {\n                    defaultConfig.onDismiss(flash);\n                }\n            }\n        };\n        dataFactory.clear = function() {\n            while ($rootScope.flashes.length > 0) {\n                dataFactory.dismiss($rootScope.flashes[0].id);\n            }\n        };\n        dataFactory.reset = dataFactory.clear;\n        function findIndexById(id) {\n            return $rootScope.flashes.map((flash) => flash.id).indexOf(id);\n        }\n\n        return dataFactory;\n    }];\n});\n"]}